<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Molly Lewis and Christina Bergmann" />


<title>Reproducibility Analyses</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<script src="libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
div.sourceCode {
  overflow-x: visible;
}
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="libs/navigation-1.0/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<script src="libs/navigation-1.0/codefolding.js"></script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.9em;
  padding-left: 5px;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All</a></li>
</ul>
</div>


<h1 class="title toc-ignore">Reproducibility Analyses</h1>
<h4 class="author"><em>Molly Lewis and Christina Bergmann</em></h4>
<h4 class="date"><em>This report was rendered on 2016-05-25 and will be automatically re-rendered nightly, reflecting any changes in the data or code.</em></h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>To draw inferences from null hypothesis testing, a range of assumptions must be made. Here we look at our database to examine the extent to which these assumptions are valid within the language acquisition literature. We find broadly that these assumptions are merited.</p>
</div>
<div id="data-availabilityreporting-standards" class="section level1">
<h1>Data availability/reporting standards</h1>
<p>An important component of reproducbility is complete description of data in published report. This is critical both for evaluating an individual study, but also for the purposes of a cumulative science (e.g. meta-analysis). Here we explore the extent to which papers report desired statistics such as test-statistics mean and standard deviation, effect sizes and test statistics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">counts =<span class="st"> </span>all_data %&gt;%
<span class="st">            </span><span class="kw">summarise</span>(<span class="dt">test_statistic =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(t) |<span class="st"> </span>!<span class="kw">is.na</span>(F) |<span class="st"> </span>!<span class="kw">is.na</span>(r)),
                      <span class="dt">means =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(x_1)),
                      <span class="dt">SD =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(SD_1)),
                      <span class="dt">d =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(d_calc)),
                      <span class="dt">g =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(g_calc)),
                      <span class="dt">r =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(r_calc)),
                      <span class="dt">age_range =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(age_range_1)),
                      <span class="dt">gender =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(gender_1))) %&gt;%
<span class="st">            </span><span class="kw">gather</span>(<span class="st">&quot;coded_variable&quot;</span>, <span class="st">&quot;n&quot;</span>) %&gt;%
<span class="st">            </span><span class="kw">mutate</span>(<span class="dt">coded =</span> <span class="st">&quot;coded&quot;</span>) %&gt;%
<span class="st">            </span><span class="kw">mutate</span>(<span class="dt">total =</span> <span class="kw">nrow</span>(all_data))  %&gt;%
<span class="st">            </span><span class="kw">mutate</span>(<span class="dt">coded_variable =</span> <span class="kw">factor</span>(coded_variable, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;d&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;r&quot;</span>, <span class="st">&quot;means&quot;</span>,
                                                                        <span class="st">&quot;SD&quot;</span>, <span class="st">&quot;test_statistic&quot;</span>,
                                                                        <span class="st">&quot;age_range&quot;</span>, <span class="st">&quot;gender&quot;</span>)))
counts =<span class="st"> </span>counts %&gt;%
<span class="st">             </span><span class="kw">mutate</span>(<span class="dt">n =</span> total -<span class="st"> </span>n, 
                    <span class="dt">coded =</span> <span class="st">&quot;uncoded&quot;</span>)  %&gt;%
<span class="st">             </span><span class="kw">bind_rows</span>(counts) %&gt;%
<span class="st">             </span><span class="kw">mutate</span>(<span class="dt">n_lab =</span> <span class="kw">ifelse</span>(coded ==<span class="st"> &quot;coded&quot;</span>, n, <span class="st">&quot;&quot;</span>)) %&gt;%
<span class="st">             </span><span class="kw">arrange</span>(coded)
<span class="kw">ggplot</span>(counts) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> coded_variable, 
               <span class="dt">y =</span> n/total,
               <span class="dt">fill =</span> coded,
              <span class="dt">order =</span> coded), 
           <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Proportion coded&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Coded variable&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;All data&quot;</span>) +<span class="st"> </span>
<span class="st">   </span><span class="co">#annotate(&quot;text&quot;, x = 1, y = .9, </span>
<span class="st">    </span><span class="co">#        label = paste(&quot;N =&quot;, counts$total[1]), size = 6) + </span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>( <span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;grey&quot;</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> n_lab, <span class="dt">x =</span> coded_variable, <span class="dt">y =</span> n/total -.<span class="dv">06</span>) )+
<span class="st">  </span><span class="kw">theme_bw</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
       <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
       <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">20</span>),
       <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">30</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/unnamed-chunk-1-1.png" title="" alt="" width="1056" /> This analysis is in practice difficult because our many of our source MA’s include effect sizes that were included by the coders. Similarly, the proportion of coded gender in many cases reflects only that the coder chose not to code that, not that this information was not present. Nevertheless, this analysis gives us a good sense of the the proportion of papers that report means and standard deviations (about two-thirds).</p>
<p>By MA</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">counts =<span class="st"> </span>all_data %&gt;%
<span class="st">            </span><span class="kw">group_by</span>(dataset) %&gt;%
<span class="st">            </span><span class="kw">summarise</span>(<span class="dt">test_statistic =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(t) |<span class="st"> </span>!<span class="kw">is.na</span>(F)),
                      <span class="dt">means =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(x_1)),
                      <span class="dt">SD =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(SD_1)),
                      <span class="dt">d =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(d_calc)),
                      <span class="dt">g =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(g_calc)),
                      <span class="dt">r =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(r_calc)),
                      <span class="dt">age_range =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(age_range_1)),
                      <span class="dt">gender =</span> <span class="kw">sum</span>(!<span class="kw">is.na</span>(gender_1)),
                      <span class="dt">total =</span> <span class="kw">n</span>()) %&gt;%
<span class="st">            </span><span class="kw">gather</span>(coded_variable, n, -dataset, -total) %&gt;%
<span class="st">            </span><span class="kw">mutate</span>(<span class="dt">coded =</span> <span class="st">&quot;coded&quot;</span>) %&gt;%
<span class="st">            </span><span class="kw">mutate</span>(<span class="dt">coded_variable =</span> <span class="kw">factor</span>(coded_variable, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;d&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;r&quot;</span>, <span class="st">&quot;means&quot;</span>,
                                                                        <span class="st">&quot;SD&quot;</span>, <span class="st">&quot;test_statistic&quot;</span>,
                                                                        <span class="st">&quot;age_range&quot;</span>, <span class="st">&quot;gender&quot;</span>)))

counts =<span class="st"> </span>counts %&gt;%
<span class="st">             </span><span class="kw">mutate</span>(<span class="dt">n =</span> total -<span class="st"> </span>n, 
                    <span class="dt">coded =</span> <span class="st">&quot;uncoded&quot;</span>)  %&gt;%
<span class="st">             </span><span class="kw">bind_rows</span>(counts) %&gt;%
<span class="st">             </span><span class="kw">mutate</span>(<span class="dt">n_lab =</span> <span class="kw">ifelse</span>(coded ==<span class="st"> &quot;coded&quot;</span>, n, <span class="st">&quot;&quot;</span>)) %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(coded)

<span class="kw">ggplot</span>(counts, <span class="kw">aes</span>(<span class="dt">fill =</span> coded)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(coded_variable), 
               <span class="dt">y =</span> n/total),  ## FIX THIS
           <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,
           <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(~dataset, <span class="dt">ncol=</span><span class="dv">2</span>) +
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Proportion coded&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Coded variable&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;grey&quot;</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> n_lab,
              <span class="dt">x =</span> coded_variable, 
              <span class="dt">y =</span> n/total -.<span class="dv">06</span>)) +
<span class="st">  </span><span class="kw">theme_bw</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
        <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">20</span>),
        <span class="dt">strip.background  =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">30</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/unnamed-chunk-2-1.png" title="" alt="" width="960" /></p>
</div>
<div id="sample-sizes-and-exclusions" class="section level1">
<h1>Sample sizes and exclusions</h1>
<p>Here we examine how sample sizes and exclusion rates are related to other variables of inteerest.</p>
<div id="how-do-sample-sizes-vary-as-a-function-of-age" class="section level2">
<h2>How do sample sizes vary as a function of age?</h2>
<p>Given that effect size broadly increases with age, we would expect sample sizes to decrease. Broadly, the data are consistent with this. Phonemic discriminatiion (native) is an exception, but this may be due to differences in method (?).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">all =<span class="st"> </span>all_data %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_total =</span> <span class="kw">ifelse</span>(!<span class="kw">is.na</span>(n_2), n_1 +<span class="st"> </span>n_2, n_1)) %&gt;%
<span class="st">  </span><span class="kw">select</span>(dataset, d_calc, 
         mean_age_1, n_total,
         n_excluded_1, num_trials, method)
 
<span class="kw">ggplot</span>(all, <span class="kw">aes</span>(<span class="dt">x =</span> mean_age_1, <span class="dt">y =</span> n_total, <span class="dt">color =</span> dataset)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
<span class="st">  </span><span class="kw">facet_wrap</span>(~dataset, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/unnamed-chunk-3-1.png" title="" alt="" width="960" /></p>
</div>
<div id="do-sample-sizes-vary-with-effect-sizes" class="section level2">
<h2>Do sample sizes vary with effect sizes?</h2>
<p>Here we explore a more direct test that sample sizes are coupled with effect sizes. We test this by looking at the relationship between sample sizes and effect size, after residualizing out the effect of (1) phenomenon, (2) age, and (3) method.</p>
<p>Compute residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">full.model =<span class="st"> </span><span class="kw">rma</span>(d_calc ~<span class="st"> </span>method +<span class="st"> </span>dataset +<span class="st"> </span>mean_age_1, 
        <span class="dt">vi =</span> d_var_calc, <span class="dt">data =</span> all_data, <span class="dt">method =</span> <span class="st">&quot;REML&quot;</span>)

residuals =<span class="st"> </span><span class="kw">rstandard</span>(full.model)

all_data =<span class="st"> </span>all_data %&gt;%
<span class="st">            </span><span class="kw">bind_cols</span>(<span class="kw">as.data.frame</span>(residuals$resid),
                      <span class="kw">as.data.frame</span>(residuals$z)) %&gt;%
<span class="st">            </span><span class="kw">rename</span>(<span class="dt">residual.d =</span> <span class="st">`</span><span class="dt">residuals$resid</span><span class="st">`</span>, 
                   <span class="dt">residual.d.s =</span> <span class="st">`</span><span class="dt">residuals$z</span><span class="st">`</span>) <span class="co"># standardized</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ns_ds =<span class="st"> </span>all_data %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_total =</span> <span class="kw">ifelse</span>(!<span class="kw">is.na</span>(n_2), n_1 +<span class="st"> </span>n_2, n_1)) %&gt;%
<span class="st">  </span><span class="kw">select</span>(dataset, d_calc, residual.d.s,
         mean_age_1, n_total) 

<span class="kw">ggplot</span>(ns_ds , <span class="kw">aes</span>(<span class="dt">y =</span> n_total, <span class="dt">x =</span> residual.d.s, <span class="dt">color =</span> dataset)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Residual effect size&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(~dataset, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/unnamed-chunk-5-1.png" title="" alt="" width="960" /></p>
<p>If sample size and effect sizes were appropriately coupled, we should expect sample to decrease as effect size increases. Across 3 meta-analyses, we find the opposite pattern: sample size increases with effect size. This suggest that researchers either are not prospectively planning their sample sizes based on effect size estimates.</p>
</div>
<div id="does-the-number-of-excluded-infants-affect-effect-sizes" class="section level2">
<h2>Does the number of excluded infants affect effect sizes?</h2>
<p>Here we look at whether the number of excluded infants varies as a function of effect size. If infants are excluded based on an indepenent criteria, and before looking at the data, there should be no relationship. Again, we use residualized effect sizes.</p>
<p>However, there are some techincal issues we need to address before properly doing this analysis:</p>
<ul>
<li>not here that different data sets use differently names columsn to indicate exclusions (“n_excluded”, “n_excluded_1”, “n_excluded_fussers”)</li>
<li>an additional complicaiton: are the exlcusions part of the n?</li>
<li>we don’t have num_trials for any, but this would be great to look at</li>
<li>what’s up with the n_excluded &gt; n?</li>
</ul>
<p>Compute residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">age.method =<span class="st"> </span><span class="kw">rma</span>(mean_age_1 ~<span class="st"> </span>method +<span class="st"> </span>dataset, 
        <span class="dt">vi =</span> d_var_calc, <span class="dt">data =</span> all_data, <span class="dt">method =</span> <span class="st">&quot;REML&quot;</span>)

residuals.age.method =<span class="st"> </span><span class="kw">rstandard</span>(age.method)

all_data =<span class="st"> </span>all_data %&gt;%
<span class="st">            </span><span class="kw">bind_cols</span>(<span class="kw">as.data.frame</span>(residuals.age.method$resid),
                      <span class="kw">as.data.frame</span>(residuals.age.method$z)) %&gt;%
<span class="st">            </span><span class="kw">rename</span>(<span class="dt">residual.d.age =</span> <span class="st">`</span><span class="dt">residuals.age.method$resid</span><span class="st">`</span>, 
                   <span class="dt">residual.d.s.age =</span> <span class="st">`</span><span class="dt">residuals.age.method$z</span><span class="st">`</span>) <span class="co"># standardized</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exclusions =<span class="st"> </span>all_data %&gt;%
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(n_excluded_1) ||<span class="st"> </span>!<span class="kw">is.na</span>(n_excluded_2)) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_excluded =</span>  <span class="kw">ifelse</span>(!<span class="kw">is.na</span>(n_excluded_2), n_excluded_1 +<span class="st"> </span>n_excluded_2, n_excluded_1),
         <span class="dt">n_total =</span> <span class="kw">ifelse</span>(!<span class="kw">is.na</span>(n_2), n_1 +<span class="st"> </span>n_2, n_1)) %&gt;%
<span class="st">  </span><span class="kw">select</span>(dataset, d_calc, 
         mean_age_1, n_total,
         n_excluded, num_trials, method, residual.d.s, residual.d.s.age) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_excluded =</span> n_excluded/n_total) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(prop_excluded &lt;<span class="st"> </span><span class="dv">1</span>)
 
  <span class="kw">ggplot</span>(exclusions, <span class="kw">aes</span>(<span class="dt">x =</span> prop_excluded, <span class="dt">y =</span>residual.d.s ,
                       <span class="dt">color =</span> dataset)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;prop. excluded as a function of d&quot;</span>) +
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;proportion excluded&quot;</span>) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;d&quot;</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(~dataset, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/unnamed-chunk-7-1.png" title="" alt="" width="960" /></p>
</div>
<div id="does-proportion-excluded-vary-as-a-function-of-age" class="section level2">
<h2>Does proportion excluded vary as a function of age?</h2>
<p>Again, if there is no bias we should see no relationship. In contrast, we see some evidence that proportion excluded increases with age. This is difficult to interpret though, for the reasons described above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(exclusions, <span class="kw">aes</span>(<span class="dt">x =</span> residual.d.s.age, <span class="dt">y =</span> prop_excluded,
                       <span class="dt">color =</span> dataset)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;prop. excluded as a function of age&quot;</span>) +
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;mean age (months)&quot;</span>) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;proportion excluded&quot;</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>()  +<span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(~dataset, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/Exclusions_nExcluded-1.png" title="" alt="" width="960" /></p>
</div>
</div>
<div id="publication-bias" class="section level1">
<h1>Publication Bias</h1>
<p>If studies are randomly sampled from the population of possible studies, effect sizes should not be bias. Here we examine this assumption, using residualized effect sizes.</p>
<div id="do-effect-sizes-vary-as-a-function-of-year" class="section level2">
<h2>Do effect sizes vary as a function of year?</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">years.df =<span class="st"> </span>all_data %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">as.numeric</span>(<span class="kw">unlist</span>(<span class="kw">lapply</span>(<span class="kw">strsplit</span>(<span class="kw">unlist</span>(all_data$study_ID),
                                                  <span class="st">&quot;[^0-9]+&quot;</span>),  function(x) <span class="kw">unlist</span>(x)[<span class="dv">2</span>])))) 

<span class="kw">ggplot</span>(years.df , <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> residual.d.s, <span class="dt">color =</span> dataset)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
<span class="st">  </span><span class="kw">facet_wrap</span>(~<span class="st"> </span>dataset, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;published year&quot;</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/unnamed-chunk-8-1.png" title="" alt="" width="960" /> We see a bias of year here: Studies conducted early on in a literature tend to have larger effect sizes than later studies.</p>
</div>
<div id="does-age-vary-as-a-function-of-year" class="section level2">
<h2>Does age vary as a function of year?</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(years.df , <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> residual.d.s.age, <span class="dt">color =</span> dataset)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
<span class="st">  </span><span class="kw">facet_wrap</span>(~<span class="st"> </span>dataset, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;published year&quot;</span>)  +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/unnamed-chunk-9-1.png" title="" alt="" width="960" /> In some literatures, we see a trend toward looking for the phenomenon in younger children over time.</p>
</div>
<div id="does-effect-size-vary-as-a-function-of-number-of-authors" class="section level2">
<h2>Does effect size vary as a function of number of authors?</h2>
<p>Not really enough data to do this analysis. (maybe cut?)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">all_data$short_cite2 =<span class="st"> </span><span class="kw">str_replace_all</span>(all_data$short_cite, <span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>)
all_data$short_cite2 =<span class="st"> </span><span class="kw">str_replace_all</span>(all_data$short_cite2, <span class="st">&quot;&amp;&quot;</span>, <span class="st">&quot;,&quot;</span>)
all_data$num_authors =<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(<span class="kw">lapply</span>(all_data$short_cite2, 
                                     function(x) <span class="kw">unlist</span>(<span class="kw">strsplit</span>(x, <span class="st">&#39;,+&#39;</span>))), 
                              function(x) <span class="kw">length</span>(<span class="kw">which</span>(x !=<span class="st"> &quot;&quot;</span>))))
all_data$num_authors =<span class="st">  </span><span class="kw">as.numeric</span>(<span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;et al&quot;</span>, all_data$short_cite), <span class="st">&quot;NA&quot;</span>,
                                          all_data$num_authors)) <span class="co"># deal with miss coded short_cites (et al.)</span>
all_data$short_cite2 &lt;-<span class="st"> </span><span class="ot">NULL</span>

all_data %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> num_authors, <span class="dt">y =</span> residual.d.s, <span class="dt">colour =</span> dataset)) +
<span class="st">  </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
<span class="st">  </span><span class="kw">facet_wrap</span>(~dataset, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>()+
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/unnamed-chunk-10-1.png" title="" alt="" width="960" /></p>
</div>
</div>
<div id="individual-meta-analysis-power" class="section level1">
<h1>Individual meta-analysis power</h1>
<div id="what-is-the-power-to-determine-if-the-overall-effect-is-greater-than-zero" class="section level2">
<h2>What is the power to determine if the overall effect is greater than zero?</h2>
<p>Here I calculated the power to detect an effect using a random effect model (Hedges &amp; Pigott, 2001; Valentine, Pigott, &amp; Rothstein, 2010). Note that this information is redundant with confidence intervals on the estimated effect size, and the power in all of these MAs is essentially 1. Below, I ran a simulation sampling n papers from each meta-analysis, and calculating power. We need surprisingly few studies to get relatively high power.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">calculate_ma_power &lt;-<span class="st"> </span>function(sample_data) {
  ALPHA &lt;-<span class="st">  </span>.<span class="dv">05</span>
  NTAILS &lt;-<span class="st">  </span><span class="dv">2</span>
  c_crit &lt;-<span class="st">  </span><span class="kw">qnorm</span>(ALPHA/NTAILS, <span class="dt">lower.tail =</span> F)
  model &lt;-<span class="st"> </span><span class="kw">rma</span>(d_calc, <span class="dt">vi =</span> d_var_calc, <span class="dt">data =</span> sample_data,
               <span class="dt">method =</span> <span class="st">&quot;REML&quot;</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">maxiter =</span> <span class="dv">1000</span>, <span class="dt">stepadj =</span> <span class="fl">0.5</span>))
  lambda  &lt;-<span class="st">  </span>model$b[<span class="dv">1</span>] /<span class="st"> </span>model$se[<span class="dv">1</span>] <span class="co"># Valentine, Eq. [6]</span>
  power &lt;-<span class="st">  </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">pnorm</span>(c_crit -<span class="st"> </span>lambda)
  power
}

one_sample &lt;-<span class="st"> </span>function(ma_data, summary_function, n) {
   function(k) {
      <span class="kw">do.call</span>(summary_function, <span class="kw">list</span>(<span class="kw">sample_n</span>(ma_data, <span class="dt">size =</span> n, <span class="dt">replace =</span> F)))
   }
}

all_samples &lt;-<span class="st"> </span>function(ma_data, summary_function, n, nboot) {
  sample_values &lt;-<span class="st"> </span><span class="dv">1</span>:nboot %&gt;%
<span class="st">    </span><span class="kw">map</span>(<span class="kw">one_sample</span>(ma_data, summary_function, n)) %&gt;%
<span class="st">    </span><span class="kw">unlist</span>()
  <span class="kw">data.frame</span>(<span class="dt">n =</span> n,
             <span class="dt">mean =</span> <span class="kw">mean</span>(sample_values),
             <span class="dt">ci_lower =</span> <span class="kw">ci_lower</span>(sample_values),
             <span class="dt">ci_upper =</span> <span class="kw">ci_upper</span>(sample_values),
             <span class="dt">row.names =</span> <span class="ot">NULL</span>)
}

dataset_data &lt;-<span class="st"> </span>function(ma_data, summary_function, nboot) {
  overall &lt;-<span class="st"> </span><span class="kw">do.call</span>(summary_function, <span class="kw">list</span>(ma_data))
  <span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(ma_data), <span class="dt">by =</span> <span class="dv">1</span>) %&gt;%
<span class="st">    </span><span class="kw">map</span>(function(n) <span class="kw">all_samples</span>(ma_data, 
                                summary_function, n, nboot)) %&gt;%
<span class="st">    </span><span class="kw">bind_rows</span>() %&gt;%
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">dataset =</span> <span class="kw">unique</span>(ma_data$dataset),
           <span class="dt">overall_est =</span> overall)
}

power_data &lt;-<span class="st"> </span>all_data %&gt;%
<span class="st">  </span><span class="kw">split</span>(.$dataset) %&gt;%
<span class="st">  </span><span class="kw">map</span>(function(ma_data) <span class="kw">dataset_data</span>(ma_data, 
                                     calculate_ma_power, <span class="dv">50</span>)) %&gt;%
<span class="st">  </span><span class="kw">bind_rows</span>()

<span class="kw">ggplot</span>(power_data, <span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> mean, <span class="dt">fill =</span> dataset)) +
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> ci_lower, <span class="dt">ymax =</span> ci_upper), <span class="dt">alpha =</span> <span class="fl">0.5</span>) +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> overall_est), <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) +
<span class="st">  </span><span class="kw">geom_line</span>( <span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> mean)) +
<span class="st">  </span><span class="kw">facet_wrap</span>(~dataset) +
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Number of effect sizes&quot;</span>) +
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Meta-analytic power&quot;</span>) +
<span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>,<span class="dv">150</span>) +
<span class="st">  </span><span class="kw">scale_fill_solarized</span>(<span class="dt">guide =</span> <span class="ot">FALSE</span>) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">family =</span> <span class="st">&quot;Open Sans&quot;</span>),
        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</code></pre></div>
</div>
<div id="what-is-the-power-to-determine-if-theres-a-moderator-e.g.age" class="section level2">
<h2>What is the power to determine if there’s a moderator (e.g. age)?</h2>
<p>Not totally sure how to do this. Valentine et al. (2001) say it’s difficult without the raw data?</p>
</div>
</div>
<div id="trim-and-fill" class="section level1">
<h1>Trim-and-fill</h1>
<p>Corrects for selective reporting on the basis of effect size (fewer small effects; Duval &amp; Tweedie, 2000a, 2000b). The routines and plotting tools stem from the R library “metafor” (Viechtbauer).</p>
<p>[TODO: Adapt to Metalab style]</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### fit random-effects model and plot

datasets =<span class="st"> </span><span class="kw">unique</span>(all_data$short_name)

for (i in <span class="dv">1</span>:<span class="kw">length</span>(datasets)) {
  my_data =<span class="st"> </span>all_data[all_data$short_name ==<span class="st">  </span>datasets[i],]
  res &lt;-<span class="st"> </span><span class="kw">rma</span>(d_calc, d_var_calc, <span class="dt">data =</span> my_data)
  taf &lt;-<span class="st"> </span><span class="kw">trimfill</span>(res)
  <span class="kw">funnel</span>(taf, <span class="dt">main =</span> datasets[i])
}</code></pre></div>
<p><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/Trim and Fill-1.png" title="" alt="" width="672" /><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/Trim and Fill-2.png" title="" alt="" width="672" /><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/Trim and Fill-3.png" title="" alt="" width="672" /><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/Trim and Fill-4.png" title="" alt="" width="672" /><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/Trim and Fill-5.png" title="" alt="" width="672" /><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/Trim and Fill-6.png" title="" alt="" width="672" /><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/Trim and Fill-7.png" title="" alt="" width="672" /><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/Trim and Fill-8.png" title="" alt="" width="672" /><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/Trim and Fill-9.png" title="" alt="" width="672" /><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/Trim and Fill-10.png" title="" alt="" width="672" /><img src="/home/ubuntu/metalab/reports/out/reproducibility_files/figure-html/Trim and Fill-11.png" title="" alt="" width="672" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
