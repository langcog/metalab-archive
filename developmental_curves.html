<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Page Piccinini and Michael Frank" />


<title>Developmental curve comparison</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<script src="libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
div.sourceCode {
  overflow-x: visible;
}
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="libs/navigation-1.0/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<script src="libs/navigation-1.0/codefolding.js"></script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.9em;
  padding-left: 5px;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All</a></li>
</ul>
</div>


<h1 class="title toc-ignore">Developmental curve comparison</h1>
<h4 class="author"><em>Page Piccinini and Michael Frank</em></h4>
<h4 class="date"><em>This report was rendered on 2016-06-15 and will be automatically re-rendered nightly, reflecting any changes in the data or code.</em></h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The goal for this analysis was to better understand the shape of the developmental curve. To do this we used linear mixed effects models, so that the variance of individual meta-analyses could be accounted for.</p>
<p>Summary of investigations:</p>
<ul>
<li>Meta-analytic mixed-effects are promising, butâ€¦</li>
<li>The random effects structure (specifically if we nest paper effects within meta-analysis) makes a big difference to the implied curve shape.</li>
<li>Subsetting to only studies with multiple age groups improves performance.</li>
</ul>
</div>
<div id="simple-random-effects-structure" class="section level1">
<h1>Simple random effects structure</h1>
<p>Below is our data set separated by meta-analysis with four curve types: 1) linear, 2) logarithmic, 3) quadratic, and 4) both linear and logarithmic predictors.</p>
<p><img src="developmental_curves_files/figure-html/unnamed-chunk-2-1.png" title="" alt="" width="672" /></p>
<p>We ran mixed effects regressions where meta-analysis (data set) was included as a random intercept for our four models. We then ran Chi-squared tests to compare the different models to one another. Model comparison found the quadratic model to be a better fit than the linear model and the logarithmic model, but no difference between the linear and logarithmic model. The two predictor model (linear and log) also outperformed both the single predictor linear model and the single predictor logarithmic model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lin_lmer &lt;-<span class="st"> </span><span class="kw">lmer</span>(d_calc ~<span class="st"> </span>mean_age +<span class="st"> </span>
<span class="st">                </span>(<span class="dv">1</span> |<span class="st"> </span>dataset), 
                <span class="dt">weights =</span> <span class="dv">1</span>/d_var_calc, 
                <span class="dt">REML =</span> F, <span class="dt">data =</span> all_data)

log_lmer &lt;-<span class="st"> </span><span class="kw">lmer</span>(d_calc ~<span class="st"> </span><span class="kw">log</span>(mean_age) +<span class="st"> </span>
<span class="st">                </span>(<span class="dv">1</span> |<span class="st"> </span>dataset), 
                <span class="dt">weights =</span> <span class="dv">1</span>/d_var_calc, 
                <span class="dt">REML =</span> F, <span class="dt">data =</span> all_data)

quad_lmer &lt;-<span class="st"> </span><span class="kw">lmer</span>(d_calc ~<span class="st"> </span><span class="kw">I</span>(mean_age^<span class="dv">2</span>) +<span class="st"> </span>
<span class="st">                 </span>(<span class="dv">1</span> |<span class="st"> </span>dataset), 
                 <span class="dt">weights =</span> <span class="dv">1</span>/d_var_calc, 
                 <span class="dt">REML =</span> F, <span class="dt">data =</span> all_data)

lin_log_lmer &lt;-<span class="st"> </span><span class="kw">lmer</span>(d_calc ~<span class="st"> </span>mean_age +<span class="st"> </span><span class="kw">log</span>(mean_age) +<span class="st"> </span>
<span class="st">                    </span>(<span class="dv">1</span>|<span class="st"> </span>dataset), 
                    <span class="dt">weights =</span> <span class="dv">1</span>/d_var_calc, 
                    <span class="dt">REML =</span> F, <span class="dt">data =</span> all_data)

<span class="kw">kable</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(lin_lmer)))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.1799488</td>
<td align="right">0.0985783</td>
<td align="right">1.825440</td>
</tr>
<tr class="even">
<td align="left">mean_age</td>
<td align="right">0.0006621</td>
<td align="right">0.0001343</td>
<td align="right">4.929155</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(log_lmer)))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.2859868</td>
<td align="right">0.2618526</td>
<td align="right">-1.092167</td>
</tr>
<tr class="even">
<td align="left">log(mean_age)</td>
<td align="right">0.1245926</td>
<td align="right">0.0431648</td>
<td align="right">2.886442</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(quad_lmer)))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.3006590</td>
<td align="right">0.0893208</td>
<td align="right">3.366059</td>
</tr>
<tr class="even">
<td align="left">I(mean_age^2)</td>
<td align="right">0.0000006</td>
<td align="right">0.0000001</td>
<td align="right">5.702798</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(lin_log_lmer)))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.1331157</td>
<td align="right">0.3978210</td>
<td align="right">2.848306</td>
</tr>
<tr class="even">
<td align="left">mean_age</td>
<td align="right">0.0012080</td>
<td align="right">0.0002579</td>
<td align="right">4.683613</td>
</tr>
<tr class="odd">
<td align="left">log(mean_age)</td>
<td align="right">-0.2026467</td>
<td align="right">0.0819727</td>
<td align="right">-2.472124</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">anova</span>(lin_lmer, log_lmer))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">logLik</th>
<th align="right">deviance</th>
<th align="right">Chisq</th>
<th align="right">Chi Df</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lin_lmer</td>
<td align="right">4</td>
<td align="right">1628.085</td>
<td align="right">1647.209</td>
<td align="right">-810.0426</td>
<td align="right">1620.085</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">log_lmer</td>
<td align="right">4</td>
<td align="right">1643.550</td>
<td align="right">1662.674</td>
<td align="right">-817.7748</td>
<td align="right">1635.550</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">anova</span>(lin_lmer, quad_lmer))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">logLik</th>
<th align="right">deviance</th>
<th align="right">Chisq</th>
<th align="right">Chi Df</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lin_lmer</td>
<td align="right">4</td>
<td align="right">1628.085</td>
<td align="right">1647.209</td>
<td align="right">-810.0426</td>
<td align="right">1620.085</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">quad_lmer</td>
<td align="right">4</td>
<td align="right">1620.028</td>
<td align="right">1639.152</td>
<td align="right">-806.0141</td>
<td align="right">1612.028</td>
<td align="right">8.05704</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">anova</span>(log_lmer, quad_lmer))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">logLik</th>
<th align="right">deviance</th>
<th align="right">Chisq</th>
<th align="right">Chi Df</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">log_lmer</td>
<td align="right">4</td>
<td align="right">1643.550</td>
<td align="right">1662.674</td>
<td align="right">-817.7748</td>
<td align="right">1635.550</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">quad_lmer</td>
<td align="right">4</td>
<td align="right">1620.028</td>
<td align="right">1639.152</td>
<td align="right">-806.0141</td>
<td align="right">1612.028</td>
<td align="right">23.52152</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">anova</span>(lin_lmer, lin_log_lmer))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">logLik</th>
<th align="right">deviance</th>
<th align="right">Chisq</th>
<th align="right">Chi Df</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lin_lmer</td>
<td align="right">4</td>
<td align="right">1628.085</td>
<td align="right">1647.209</td>
<td align="right">-810.0426</td>
<td align="right">1620.085</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">lin_log_lmer</td>
<td align="right">5</td>
<td align="right">1624.004</td>
<td align="right">1647.909</td>
<td align="right">-807.0018</td>
<td align="right">1614.004</td>
<td align="right">6.081592</td>
<td align="right">1</td>
<td align="right">0.0136598</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">anova</span>(log_lmer, lin_log_lmer))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">logLik</th>
<th align="right">deviance</th>
<th align="right">Chisq</th>
<th align="right">Chi Df</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">log_lmer</td>
<td align="right">4</td>
<td align="right">1643.550</td>
<td align="right">1662.674</td>
<td align="right">-817.7748</td>
<td align="right">1635.550</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">lin_log_lmer</td>
<td align="right">5</td>
<td align="right">1624.004</td>
<td align="right">1647.909</td>
<td align="right">-807.0018</td>
<td align="right">1614.004</td>
<td align="right">21.54608</td>
<td align="right">1</td>
<td align="right">3.5e-06</td>
</tr>
</tbody>
</table>
<p>Focusing on the linear, log, and two predictor (linear and log) models, we built predictions for all complete meta-analyses. The plot separated by meta-analysis is presented below. The linear and two predictor models are pretty similar, mainly being different at very early ages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">all_data_preds &lt;-<span class="st"> </span>all_data %&gt;%
<span class="st">  </span><span class="kw">select</span>(dataset, short_name, d_calc, d_var_calc, mean_age, study_ID) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.)) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lin_pred =</span> <span class="kw">predict</span>(lin_lmer)) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_pred =</span> <span class="kw">predict</span>(log_lmer)) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lin_log_pred =</span> <span class="kw">predict</span>(lin_log_lmer))</code></pre></div>
<p><img src="developmental_curves_files/figure-html/unnamed-chunk-5-1.png" title="" alt="" width="672" /></p>
<p>Overall this method looks pretty good. It seems like the linear predictor in the two predictor model is smoothing the logs at the edges, and the random effects are working to capture cross data set variability.</p>
</div>
<div id="complex-random-effects-structure-nested-paper-effects" class="section level1">
<h1>Complex random effects structure (nested paper effects)</h1>
<p>We decided to expand our random effects structure to include paper (study_ID) nested in meta-analysis (data set) to capture the fact that a given meta-analysis has a specific set of papers, and may have multiple entries from the same paper. Here we focused on the two predictor model. The simpler random effects model from above is repeated here for easy comparison. A Chi-squared test finds a significant difference between the models, with the model with the more complex random effects structure having a lower AIC.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lin_log_paper_lmer &lt;-<span class="st"> </span><span class="kw">lmer</span>(d_calc ~<span class="st"> </span>mean_age +<span class="st"> </span><span class="kw">log</span>(mean_age) +<span class="st"> </span>
<span class="st">                          </span>(<span class="dv">1</span> |<span class="st"> </span>dataset /<span class="st"> </span>study_ID),
                          <span class="dt">weights =</span> <span class="dv">1</span>/d_var_calc, 
                          <span class="dt">REML =</span> F, <span class="dt">data =</span> all_data)

<span class="kw">kable</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(lin_log_paper_lmer)))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.1068885</td>
<td align="right">0.4313395</td>
<td align="right">2.566165</td>
</tr>
<tr class="even">
<td align="left">mean_age</td>
<td align="right">0.0013802</td>
<td align="right">0.0002710</td>
<td align="right">5.091971</td>
</tr>
<tr class="odd">
<td align="left">log(mean_age)</td>
<td align="right">-0.2027956</td>
<td align="right">0.0879156</td>
<td align="right">-2.306707</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(lin_log_lmer)))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.1331157</td>
<td align="right">0.3978210</td>
<td align="right">2.848306</td>
</tr>
<tr class="even">
<td align="left">mean_age</td>
<td align="right">0.0012080</td>
<td align="right">0.0002579</td>
<td align="right">4.683613</td>
</tr>
<tr class="odd">
<td align="left">log(mean_age)</td>
<td align="right">-0.2026467</td>
<td align="right">0.0819727</td>
<td align="right">-2.472124</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">anova</span>(lin_log_lmer, lin_log_paper_lmer))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">logLik</th>
<th align="right">deviance</th>
<th align="right">Chisq</th>
<th align="right">Chi Df</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lin_log_lmer</td>
<td align="right">5</td>
<td align="right">1624.004</td>
<td align="right">1647.909</td>
<td align="right">-807.0018</td>
<td align="right">1614.004</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">lin_log_paper_lmer</td>
<td align="right">6</td>
<td align="right">1585.391</td>
<td align="right">1614.077</td>
<td align="right">-786.6955</td>
<td align="right">1573.391</td>
<td align="right">40.61263</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>We then predicted from this new, more complex model and compare it to the model without the nested paper random effects structure. Initial testing found that including the nested random effect in the predict algorithm led to massive overfitting, so just the simple random effects structure was used to compute predictions. Below is the figure comparing the two curves. The curves are very similar, suggesting that while adding the nesting of paper does significantly improve the model, visually the difference is very small.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lin_log_paper_preds &lt;-<span class="st"> </span><span class="kw">predict</span>(lin_log_paper_lmer, <span class="dt">re.form =</span> ~<span class="st"> </span>(<span class="dv">1</span> |<span class="st"> </span>dataset))

all_data_preds &lt;-<span class="st"> </span>all_data_preds %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lin_log_paper_pred =</span> lin_log_paper_preds)</code></pre></div>
<p><img src="developmental_curves_files/figure-html/unnamed-chunk-8-1.png" title="" alt="" width="672" /></p>
</div>
<div id="complex-random-effects-structure-random-slope" class="section level1">
<h1>Complex random effects structure (random slope)</h1>
<p>Another way to make the random effects structure more complex is to add a random slope to the model. Two more models were built with a random slope by mean age log transformed, one without the nesting of paper, and one with the nesting of paper. Summaries of the new models with the random slope and the previous models without the random slope are below. Model comparison found that the model with nested structure and the slope was better than the simplest model (no nesting, no slope). The model with both the nested structure and the slope was also better than than the model with only the slope. Based on this it appears that the best model is one that includes both the nested random effects structure and a random slope of mean age log transformed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lin_log_slope_lmer &lt;-<span class="st"> </span><span class="kw">lmer</span>(d_calc ~<span class="st"> </span>mean_age +<span class="st"> </span><span class="kw">log</span>(mean_age) +<span class="st"> </span>
<span class="st">                          </span>(<span class="kw">log</span>(mean_age)|<span class="st"> </span>dataset),
                          <span class="dt">weights =</span> <span class="dv">1</span>/d_var_calc, 
                          <span class="dt">REML =</span> F, <span class="dt">data =</span> all_data)

lin_log_paper_slope_lmer &lt;-<span class="st"> </span><span class="kw">lmer</span>(d_calc ~<span class="st"> </span>mean_age +<span class="st"> </span><span class="kw">log</span>(mean_age) +<span class="st"> </span>
<span class="st">                          </span>(<span class="kw">log</span>(mean_age)|<span class="st"> </span>dataset /<span class="st"> </span>study_ID),
                          <span class="dt">weights =</span> <span class="dv">1</span>/d_var_calc, 
                          <span class="dt">REML =</span> F, <span class="dt">data =</span> all_data)

<span class="kw">kable</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(lin_log_slope_lmer)))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.9313688</td>
<td align="right">1.2323205</td>
<td align="right">-0.7557846</td>
</tr>
<tr class="even">
<td align="left">mean_age</td>
<td align="right">0.0007506</td>
<td align="right">0.0003976</td>
<td align="right">1.8875944</td>
</tr>
<tr class="odd">
<td align="left">log(mean_age)</td>
<td align="right">0.1641281</td>
<td align="right">0.2255683</td>
<td align="right">0.7276204</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(lin_log_paper_slope_lmer)))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.7419319</td>
<td align="right">1.4481845</td>
<td align="right">-0.5123186</td>
</tr>
<tr class="even">
<td align="left">mean_age</td>
<td align="right">0.0011776</td>
<td align="right">0.0004761</td>
<td align="right">2.4731946</td>
</tr>
<tr class="odd">
<td align="left">log(mean_age)</td>
<td align="right">0.1126368</td>
<td align="right">0.2653650</td>
<td align="right">0.4244601</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(lin_log_lmer)))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.1331157</td>
<td align="right">0.3978210</td>
<td align="right">2.848306</td>
</tr>
<tr class="even">
<td align="left">mean_age</td>
<td align="right">0.0012080</td>
<td align="right">0.0002579</td>
<td align="right">4.683613</td>
</tr>
<tr class="odd">
<td align="left">log(mean_age)</td>
<td align="right">-0.2026467</td>
<td align="right">0.0819727</td>
<td align="right">-2.472124</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(lin_log_paper_lmer)))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.1068885</td>
<td align="right">0.4313395</td>
<td align="right">2.566165</td>
</tr>
<tr class="even">
<td align="left">mean_age</td>
<td align="right">0.0013802</td>
<td align="right">0.0002710</td>
<td align="right">5.091971</td>
</tr>
<tr class="odd">
<td align="left">log(mean_age)</td>
<td align="right">-0.2027956</td>
<td align="right">0.0879156</td>
<td align="right">-2.306707</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">anova</span>(lin_log_lmer, lin_log_slope_lmer))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">logLik</th>
<th align="right">deviance</th>
<th align="right">Chisq</th>
<th align="right">Chi Df</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lin_log_lmer</td>
<td align="right">5</td>
<td align="right">1624.004</td>
<td align="right">1647.909</td>
<td align="right">-807.0018</td>
<td align="right">1614.004</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">lin_log_slope_lmer</td>
<td align="right">7</td>
<td align="right">1602.127</td>
<td align="right">1635.595</td>
<td align="right">-794.0636</td>
<td align="right">1588.127</td>
<td align="right">25.87631</td>
<td align="right">2</td>
<td align="right">2.4e-06</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">anova</span>(lin_log_lmer, lin_log_paper_slope_lmer))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">logLik</th>
<th align="right">deviance</th>
<th align="right">Chisq</th>
<th align="right">Chi Df</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lin_log_lmer</td>
<td align="right">5</td>
<td align="right">1624.004</td>
<td align="right">1647.909</td>
<td align="right">-807.0018</td>
<td align="right">1614.004</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">lin_log_paper_slope_lmer</td>
<td align="right">10</td>
<td align="right">1553.905</td>
<td align="right">1601.715</td>
<td align="right">-766.9524</td>
<td align="right">1533.905</td>
<td align="right">80.09882</td>
<td align="right">5</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">anova</span>(lin_log_paper_lmer, lin_log_slope_lmer))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">logLik</th>
<th align="right">deviance</th>
<th align="right">Chisq</th>
<th align="right">Chi Df</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lin_log_paper_lmer</td>
<td align="right">6</td>
<td align="right">1585.391</td>
<td align="right">1614.077</td>
<td align="right">-786.6955</td>
<td align="right">1573.391</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">lin_log_slope_lmer</td>
<td align="right">7</td>
<td align="right">1602.127</td>
<td align="right">1635.595</td>
<td align="right">-794.0636</td>
<td align="right">1588.127</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">anova</span>(lin_log_paper_lmer, lin_log_paper_slope_lmer))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">logLik</th>
<th align="right">deviance</th>
<th align="right">Chisq</th>
<th align="right">Chi Df</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lin_log_paper_lmer</td>
<td align="right">6</td>
<td align="right">1585.391</td>
<td align="right">1614.077</td>
<td align="right">-786.6955</td>
<td align="right">1573.391</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">lin_log_paper_slope_lmer</td>
<td align="right">10</td>
<td align="right">1553.905</td>
<td align="right">1601.715</td>
<td align="right">-766.9524</td>
<td align="right">1533.905</td>
<td align="right">39.48618</td>
<td align="right">4</td>
<td align="right">1e-07</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">anova</span>(lin_log_slope_lmer, lin_log_paper_slope_lmer))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">logLik</th>
<th align="right">deviance</th>
<th align="right">Chisq</th>
<th align="right">Chi Df</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lin_log_slope_lmer</td>
<td align="right">7</td>
<td align="right">1602.127</td>
<td align="right">1635.595</td>
<td align="right">-794.0636</td>
<td align="right">1588.127</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">lin_log_paper_slope_lmer</td>
<td align="right">10</td>
<td align="right">1553.905</td>
<td align="right">1601.715</td>
<td align="right">-766.9524</td>
<td align="right">1533.905</td>
<td align="right">54.22251</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>As before, predictions were built for the new models and plotted on the data. Overall the models do look pretty similar in terms of their predicted fit of the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lin_log_slope_preds &lt;-<span class="st"> </span><span class="kw">predict</span>(lin_log_slope_lmer, <span class="dt">re.form =</span> ~<span class="st"> </span>(<span class="kw">log</span>(mean_age) |<span class="st"> </span>dataset))
lin_log_paper_slope_preds &lt;-<span class="st"> </span><span class="kw">predict</span>(lin_log_paper_slope_lmer, <span class="dt">re.form =</span> ~<span class="st"> </span>(<span class="kw">log</span>(mean_age) |<span class="st"> </span>dataset))


all_data_preds &lt;-<span class="st"> </span>all_data_preds %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lin_log_slope_pred =</span> lin_log_slope_preds) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lin_log_paper_slope_pred =</span> lin_log_paper_slope_preds)</code></pre></div>
<p><img src="developmental_curves_files/figure-html/unnamed-chunk-11-1.png" title="" alt="" width="672" /></p>
</div>
<div id="subset-to-only-those-papers-with-multiple-ages" class="section level1">
<h1>Subset to only those papers with multiple ages</h1>
<p>One concern with using a random slope with meta-analysis nested by paper is that not all studies included more than one age group. To be sure that our random slope is really appropriate, here we look at only papers where more than one age group was tested.</p>
<div id="two-age-groups" class="section level3">
<h3>Two age groups</h3>
<p>To start we arbitrarily decided on two age groups, at least more than two months apart. Below we build a new model only looking at data where papers had at least two age groups. The structure of the model is the same as the model with papers nested in meta-analysis and a random slope of mean age log transformed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">multiage_data &lt;-<span class="st"> </span>all_data_preds %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(dataset, study_ID) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count_ages =</span> <span class="kw">length</span>(<span class="kw">unique</span>(<span class="kw">floor</span>(mean_age/<span class="dv">2</span>)))) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(count_ages &gt;<span class="st"> </span><span class="dv">1</span>)

lin_log_paper_slope_multiage_lmer &lt;-<span class="st"> </span><span class="kw">lmer</span>(d_calc ~<span class="st"> </span>mean_age +<span class="st"> </span><span class="kw">log</span>(mean_age) +<span class="st"> </span>
<span class="st">                                     </span>(<span class="kw">log</span>(mean_age) |<span class="st"> </span>dataset /<span class="st"> </span>study_ID),
                                     <span class="dt">weights =</span> <span class="dv">1</span>/d_var_calc, 
                                     <span class="dt">REML =</span> F, <span class="dt">data =</span> multiage_data)

<span class="kw">kable</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(lin_log_paper_slope_multiage_lmer)))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.8613989</td>
<td align="right">1.5844297</td>
<td align="right">-0.5436650</td>
</tr>
<tr class="even">
<td align="left">mean_age</td>
<td align="right">0.0014855</td>
<td align="right">0.0005945</td>
<td align="right">2.4989139</td>
</tr>
<tr class="odd">
<td align="left">log(mean_age)</td>
<td align="right">0.1018320</td>
<td align="right">0.2927871</td>
<td align="right">0.3478022</td>
</tr>
</tbody>
</table>
<p>Predictions were calculated for the new model and visually compared to the simple model on the full data set with no nested random effects and no random slope. The plot below suggests that for this reduced data set, the addition of the nested random effects and random slope does differ greatly from the simpler model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lin_log_paper_slope_multiage_preds &lt;-<span class="st"> </span><span class="kw">predict</span>(lin_log_paper_slope_multiage_lmer, <span class="dt">re.form =</span> ~<span class="st"> </span>(<span class="kw">log</span>(mean_age)|<span class="st"> </span>dataset))

multiage_data &lt;-<span class="st"> </span>multiage_data %&gt;%
<span class="st">  </span>ungroup %&gt;%
<span class="st">  </span><span class="kw">select</span>(dataset, short_name, study_ID, d_calc, mean_age, d_var_calc, lin_log_pred) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lin_log_paper_slope_multiage_pred =</span> lin_log_paper_slope_multiage_preds)</code></pre></div>
<p><img src="developmental_curves_files/figure-html/unnamed-chunk-14-1.png" title="" alt="" width="672" /></p>
</div>
<div id="three-age-groups" class="section level3">
<h3>Three age groups</h3>
<p>We also did the same analysis, but further reducing the data set to only papers that included at least three different age groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">multiage_3_data &lt;-<span class="st"> </span>all_data_preds %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(dataset, study_ID) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count_ages =</span> <span class="kw">length</span>(<span class="kw">unique</span>(<span class="kw">floor</span>(mean_age/<span class="dv">2</span>)))) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(count_ages &gt;<span class="st"> </span><span class="dv">2</span>)

lin_log_paper_slope_multiage_3_lmer &lt;-<span class="st"> </span><span class="kw">lmer</span>(d_calc ~<span class="st"> </span>mean_age +<span class="st"> </span><span class="kw">log</span>(mean_age) +<span class="st"> </span>
<span class="st">                                     </span>(<span class="kw">log</span>(mean_age) |<span class="st"> </span>dataset /<span class="st"> </span>study_ID),
                                     <span class="dt">weights =</span> <span class="dv">1</span>/d_var_calc, 
                                     <span class="dt">REML =</span> F, <span class="dt">data =</span> multiage_3_data)

<span class="kw">kable</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(lin_log_paper_slope_multiage_3_lmer)))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.6908345</td>
<td align="right">2.0931398</td>
<td align="right">0.3300470</td>
</tr>
<tr class="even">
<td align="left">mean_age</td>
<td align="right">0.0024524</td>
<td align="right">0.0007296</td>
<td align="right">3.3611318</td>
</tr>
<tr class="odd">
<td align="left">log(mean_age)</td>
<td align="right">-0.2229199</td>
<td align="right">0.3900192</td>
<td align="right">-0.5715612</td>
</tr>
</tbody>
</table>
<p>Predictions were calculated for the new model and visually compared to the simple model on the full data set with no nested random effects and no random slope. The plot below suggests that for this further reduced data set, the difference becomes the two models becomes even more apparent.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lin_log_paper_slope_multiage_3_preds &lt;-<span class="st"> </span><span class="kw">predict</span>(lin_log_paper_slope_multiage_3_lmer, <span class="dt">re.form =</span> ~<span class="st"> </span>(<span class="kw">log</span>(mean_age)|<span class="st"> </span>dataset))

multiage_3_data &lt;-<span class="st"> </span>multiage_3_data %&gt;%
<span class="st">  </span>ungroup %&gt;%
<span class="st">  </span><span class="kw">select</span>(dataset, short_name, study_ID, d_calc, mean_age, d_var_calc, lin_log_pred) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lin_log_paper_slope_multiage_3_pred =</span> lin_log_paper_slope_multiage_3_preds)</code></pre></div>
<p><img src="developmental_curves_files/figure-html/unnamed-chunk-17-1.png" title="" alt="" width="672" /></p>
</div>
</div>
<div id="conclusions" class="section level1">
<h1>Conclusions</h1>
<p>In this report we sought to find the best curve to describe developmental data. We found that, regarding predictors, the best fit of the data appears to be a model that includes both mean age and mean age log transformed as predictors. We further improved the curve by using complex random effects structures in our regressions. We found that a more complicated random effects structure was best by: 1) nesting paper in meta-analysis, and 2) including a random slope by mean age log transformed. This structure was most appropriate when we only looked at papers that had at least two or three age groups, to ensure the random slope applied to all data analyzed.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
